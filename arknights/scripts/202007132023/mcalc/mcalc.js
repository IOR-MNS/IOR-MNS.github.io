var itemOrder={keys:["\ud2b9\uc218\uc7ac\ub8cc","\uc77c\ubc18\uc7ac\ub8cc","\uc2a4\ud0ac\uac1c\ub860","\uce69\ub958"],"\ud2b9\uc218\uc7ac\ub8cc":[["D32\uac15","\ubc14\uc774\ud3f4\ub77c \ub098\ub178\ud50c\ub808\uc774\ud06c \uce69","\uc911\ud569\uc81c"],"RMA70-24;\ub9dd\uac04 \uc911\ud569\uccb4;\ud654\uc774\ud2b8 \ud638\uc2a4 \ucf5c;\uace0\uae09 \uc5f0\ub9c8\uc11d;\uc911\ud569\uc824;\uc5f4\ud569\uae08 \ub369\uc5b4\ub9ac".split(";"),"RMA70-12;\ub9dd\uac04 \uad11\uc11d;\ub85c\uc2dd \ucf5c;\uc5f0\ub9c8\uc11d;\uc824\ub77c\ud2f4;\uc5f4\ud569\uae08".split(";")],
"\uc77c\ubc18\uc7ac\ub8cc":["\ud3ec\ub3c4\ub2f9 \ud329;\ud3f4\ub9ac\uc5d0\uc2a4\ud14c\ub974 \ud329;\uac1c\ub7c9 \uc7a5\uce58;\uc815\uc81c \uc6d0\uc554;\uc544\ucf00\ud1a4 \ud329;\uc774\ucca0 \ud329".split(";"),"\ud3ec\ub3c4\ub2f9 \ubc88\ub4e4;\ud3f4\ub9ac\uc5d0\uc2a4\ud14c\ub974 \ubc88\ub4e4;\ub9ac\ub274\uc5bc \uc7a5\uce58;\uc6d0\uc554 \ud050\ube0c \ubc88\ub4e4;\uc544\ucf00\ud1a4 \uc751\uc9d1\uccb4 \ubc88\ub4e4;\uc774\ucca0 \ubc88\ub4e4".split(";"),"\ud3ec\ub3c4\ub2f9;\ud3f4\ub9ac\uc5d0\uc2a4\ud14c\ub974;\uc7a5\uce58;\uc6d0\uc554 \ud050\ube0c;\uc544\ucf00\ud1a4 \uc751\uc9d1\uccb4;\uc774\ucca0".split(";"),
"\ub300\uccb4\ub2f9;\uc5d0\uc2a4\ud14c\ub974 \uc6d0\ub8cc;\ud30c\uc190\ub41c \uc7a5\uce58;\uc6d0\uc554;\ub514\ucf00\ud1a4;\uc774\ucca0 \uc870\uac01".split(";")],"\uc2a4\ud0ac\uac1c\ub860":[["\uc2a4\ud0ac\uac1c\ub860 \uc81c3\uad8c","\uc2a4\ud0ac\uac1c\ub860 \uc81c2\uad8c","\uc2a4\ud0ac\uac1c\ub860 \uc81c1\uad8c"]],"\uce69\ub958":[["\uce69 \ucca8\uac00\uc81c","\uad6c\ub9e4\uc99d\uba85\uc11c"],"\ubc45\uac00\ub4dc \ub4c0\uc5bc \uce69;\uac00\ub4dc \ub4c0\uc5bc \uce69;\ub514\ud39c\ub354 \ub4c0\uc5bc \uce69;\uc2a4\ub098\uc774\ud37c \ub4c0\uc5bc \uce69;\uce90\uc2a4\ud130 \ub4c0\uc5bc \uce69;\uba54\ub515 \ub4c0\uc5bc \uce69;\uc11c\ud3ec\ud130 \ub4c0\uc5bc \uce69;\uc2a4\ud398\uc15c\ub9ac\uc2a4\ud2b8 \ub4c0\uc5bc \uce69".split(";"),
"\ubc45\uac00\ub4dc \uce69\uc14b;\uac00\ub4dc \uce69\uc14b;\ub514\ud39c\ub354 \uce69\uc14b;\uc2a4\ub098\uc774\ud37c \uce69\uc14b;\uce90\uc2a4\ud130 \uce69\uc14b;\uba54\ub515 \uce69\uc14b;\uc11c\ud3ec\ud130 \uce69\uc14b;\uc2a4\ud398\uc15c\ub9ac\uc2a4\ud2b8 \uce69\uc14b".split(";"),"\ubc45\uac00\ub4dc \uce69;\uac00\ub4dc \uce69;\ub514\ud39c\ub354 \uce69;\uc2a4\ub098\uc774\ud37c \uce69;\uce90\uc2a4\ud130 \uce69;\uba54\ub515 \uce69;\uc11c\ud3ec\ud130 \uce69;\uc2a4\ud398\uc15c\ub9ac\uc2a4\ud2b8 \uce69".split(";")]},
showItem=function(f){f="<hr>";for(var p=0;p<itemOrder.keys.length;++p){var k=itemOrder[itemOrder.keys[p]];f+='<div id="category_'+p+'">';for(var g=0;g<k.length;++g){for(var l=0;l<k[g].length;++l){var t=Number(k[g][l]),x=itemData[t].grade,v=getItem_have(t),w=getItem_need(t);v=null===v?"":v;w=null===w?"":w;v=0==v?"":v;w=0==w?"":w;f+='<div align="center" class="item grade_'+x+'" id="item_'+k[g][l]+'"><div class="item_thumb"><img src="./images/item/inv_2/';f+=itemData[t].name.kr;f+='.png"><span class="item_thumb_name">';
f+=itemData[t].name.kr;f+='</span><div class="item_thumb_quantity">0</div></div><div class="item_body"><div style="height:12px"></div><div class="item_body_have">\ubcf4\uc720\ub7c9<br><input type="text" class="item_body_have_input" value="';f+=v;f+='"></div><div class="item_body_need">\ud544\uc694\ub7c9<br><input type="text" class="item_body_need_input" value="';f+=w;f+='"></div></div></div>'}f+="<div></div>"}f+="<hr>";f+="</div>"}$(".item-container").html(f);$(".item_body_have_input").off("change keyup").on("change keyup",
function(){saveInputToLocalStorage(this,"have")&&$(this).closest(".item").trigger("refresh")});$(".item_body_need_input").off("change keyup").on("change keyup",function(){saveInputToLocalStorage(this,"need")&&$(this).closest(".item").trigger("refresh")});$(".item").off("refresh").on("refresh",function(){var b=$(this),c=Number(b.attr("id").split("_")[1]),a=0>=itemData[c].craft.length?[]:itemData[c].craft[0];var d=Number(getItem_need(c));c=Number(getItem_have(c));var e=E(this);d+=e;e=d-c;e=0>e?0:e;
var m=Object.keys(b.data());for(var h=0;h<m.length;++h)0===m[h].indexOf("availability_")&&b.removeData(m[h]);for(h=0;h<a.length;++h){m=Number(a[h][1]);var r=$("#item_"+a[h][0]);if(1===r.length){var q=r;var n=e*m;r=$(b);m=$(q);r=Number(r.attr("id").split("_")[1]);var y=Number(m.attr("id").split("_")[1]);n=Number(n);if(isNaN(n))console.log("\uc624\ub958: \ub9e4\uac1c\ubcc0\uc218\ub97c \uc22b\uc790\ub85c \ubcc0\ud658\ud560 \uc218 \uc5c6\uc74c",n);else{m.data("craftDemand_"+r,n);n=Number(getItem_have(y));
var z=Number(getItem_need(y)),u=C(q);E(q);n=n+u-z;q=F(q);z=[];for(u=0;u<q.length;++u){var A=$("#item_"+q[u]),B=m.data("craftDemand_"+q[u]),D=A.data("availability_"+y);D=void 0===D?0:D;n=0>n?0:n;n<B?(A.data("availability_"+y,n),n=0):(A.data("availability_"+y,B),n-=B);B=A.data("availability_"+y);D!=B&&q[u]!=r&&z.push(A)}for(u=0;u<z.length;++u)z[u].trigger("refresh");m.trigger("refresh")}}}b=C(this);G(this,c+b-d);H(this)});var E=function(b){b=$(b);var c=0;tmp=Object.keys(b.data()).sort();for(var a=0;a<
tmp.length;++a)0===tmp[a].indexOf("craftDemand_")&&(c+=b.data(tmp[a]));return c},F=function(b){var c=$(b);b=[];c=Object.keys(c.data()).sort();for(var a=0;a<c.length;++a)0===c[a].indexOf("craftDemand_")&&b.push(Number(c[a].split("_")[1]));return b},G=function(b,c){var a=$(b),d=a.find(".item_thumb");a=a.find(".item_thumb_quantity");a.text(c);0>c?(a.addClass("minus").removeClass("plus"),d.addClass("minus")):(0<c?a.addClass("plus").removeClass("minus"):a.removeClass("plus").removeClass("minus"),d.removeClass("minus"))},
C=function(b){b=$(b);var c=b.attr("id").split("_")[1];c=0>=itemData[c].craft.length?[]:itemData[c].craft[0];for(var a=!1,d=0;d<c.length;++d){var e=c[d][0],m=Number(c[d][1]),h=b.data("availability_"+e);if(void 0!==h){h=Number(h);if(isNaN(h)){console.log("\uac00\uc6a9\ub7c9 \ub370\uc774\ud130\uc758 \uac12\uc774 \ube44\uc815\uc0c1\uc801\uc784: ",this,"\uc758 jquery data \uc18d\uc131: avail_"+e+": "+$this.data("avail_"+e));return}e=parseInt(h/m,10);a=!1===a?e:e<a?e:a}}return!1===a?0:a},H=function(b){var c=
$(b),a=Number(c.attr("id").split("_")[1]),d=Number(getItem_have(a));var e=Number(getItem_need(a));var m=C(b);e=d+m-e;m=F(b);b=[];for(d=0;d<m.length;++d){var h=$("#item_"+m[d]),r=c.data("craftDemand_"+m[d]),q=h.data("availability_"+a);q=void 0===q?0:q;e=0>e?0:e;e<r?(h.data("availability_"+a,e),e=0):(h.data("availability_"+a,r),e-=r);r=h.data("availability_"+a);q!=r&&b.push(h)}for(d=0;d<b.length;++d)a=b[d].attr("id").split("_")[1],c=Number(getItem_have(a))+C(b[d]),a=Number(getItem_need(a))+E(b[d]),
G(b[d],c-a),H(b[d])};$(".item").trigger("refresh")},saveInputToLocalStorage=function(f,p){var k=$(f);if("have"===p){var g=k.closest(".item");g=Number(g.attr("id").split("_")[1]);var l=Number(k.val().replace(/[^0-9]/g,"")),t=Number(getItem_have(g));if(isNaN(l))return k.val(0===t?"":t),!1;setItem_have(g,l);k.val(0===l?"":l);return!0}if("need"===p){g=k.closest(".item");g=Number(g.attr("id").split("_")[1]);l=Number(k.val());t=Number(getItem_need(g));if(isNaN(l))return k.val(t),!1;setItem_need(g,l);return!0}console.log("invalid inputType:",
p);return!1};$(document).ready(function(){console.log(itemData);for(var f=0;f<itemOrder.keys.length;++f)for(var p=itemOrder[itemOrder.keys[f]],k=0;k<p.length;++k)for(var g=0;g<p[k].length;++g){a:{var l=p[k][g];for(var t=Object.keys(itemData).length,x=0;x<t;++x)if(itemData[x].name.kr===l){l=x;break a}l=-1}if(0>l){console.log(p[k][g],"error");return}p[k][g]=l}showItem()});