const generateTagCodes=function(b,a,e,f,k,d,g){k="undefined"===typeof k?0:k;d="undefined"===typeof d?0:d;g="undefined"===typeof g?0:g;if(k>=e)return a[f]=g,f+1;for(;d<b.length;++d)f=generateTagCodes(b,a,e,f,k+1,d+1,g|b[d]);return f},getAvailableOperatorIDs=function(b){var a=[],e=0,f=function(l){for(var c=0;c<db.tag.keys.length;++c)if(l==db.tag[db.tag.keys[c]].name.kr)return db.tag[db.tag.keys[c]].tagCode;console.error("\uc8fc\uc5b4\uc9c4 \ud0dc\uadf8\uba85\uc744 DB\uc5d0\uc11c \ucc3e\uc9c0 \ubabb\ud568: ",
l);return!1},k=f("\uace0\uae09\ud2b9\ubcc4\ucc44\uc6a9");f=f("\ud2b9\ubcc4\ucc44\uc6a9");if(!1===k||!1===f)return!1;for(var d=0;d<db.op.keys.length;++d){var g=db.op[db.op.keys[d]];(b&g.tagCode)==b&&(0!=(k&b)?6===g.rarity&&(a[e++]=db.op.keys[d]):0!=(f&b)?5===g.rarity&&(a[e++]=db.op.keys[d]):6>g.rarity&&(a[e++]=db.op.keys[d]))}return a.filter(l=>0<=recrWhiteList[userConfig.locale.region.value].indexOf(l))},getLowestRarity=function(b){for(var a=0,e=b.length-1;0<=e;--e){a=db.op[b[e]].rarity;if(3<=a)break;
if(0===e){a=db.op[b[b.length-1]].rarity;break}}return a},calc=function(b){if(0===b.length)return[];for(var a=0;a<b.length;++a)if(0>b[a]||b[a]>=db.tag.keys.length)return[];var e=[],f=[];for(a=0;a<b.length;++a)e[a]=db.tag[b[a]].tagCode;a=1;for(var k=0;a<=b.length;++a)k=generateTagCodes(e,f,a,k);b=[];e=function(c,h){var m=db.op[c].rarity,n=db.op[h].rarity;if(m>n)return-1;if(m<n)return 1;c=db.op[c].name[userConfig.locale.lang.value];h=db.op[h].name[userConfig.locale.lang.value];return c<h?-1:c>h?1:0};
for(var d=k=a=0,g=[],l=null;a<f.length;++a)d=f[a],g=getAvailableOperatorIDs(f[a]),0<g.length&&(g.sort(e),l={},l.tagCode=d,l.opIDs=g,l.lowestRarity=getLowestRarity(g),b[k++]=l);b.sort(function(c,h){var m=c.opIDs,n=h.opIDs;c=c.lowestRarity;h=h.lowestRarity;if(c>h)return-1;if(c<h)return 1;h=db.op[m[0]].rarity;c=db.op[n[0]].rarity;return h>c?-1:h<c?1:m.length<n.length?-1:m.length>n.length?1:0});return b};
