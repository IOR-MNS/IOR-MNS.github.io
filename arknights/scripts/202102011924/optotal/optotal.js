var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(b){return b.raw=b};$jscomp.createTemplateTagFirstArgWithRaw=function(b,c){b.raw=c;return b};$jscomp.arrayIteratorImpl=function(b){var c=0;return function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var c="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return c?c.call(b):$jscomp.arrayIterator(b)};
$jscomp.arrayFromIterator=function(b){for(var c,d=[];!(c=b.next()).done;)d.push(c.value);return d};$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};var gtag_searchByNameUsed=!1,gtag_searchByRarityUsed=!1;gtag_searchByClassUsed=!1;
var openModalPrompt=function(){gtag("event","\ub300\uc6d0 \ucd94\uac00 \ud504\ub86c\ud504\ud2b8 \uc5f4\uae30",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"});var b=document.querySelector(".modal");b.style.display="block";b.style.opacity="1";doNotRefreshResult=!0;showSearchResult()},closeModalPrompt=function(){var b=document.querySelector(".modal");b.style.opacity="0";setTimeout(function(){b.style.display="none"},300);doNotRefreshResult=!1;showResult()},
getAllIDs=function(b){b=b.split("-")[0];for(var c=[],d=0;d<db.op.keys.length;++d)db.op.keys[d]===b?c.push(db.op.keys[d]):0===db.op.keys[d].indexOf(b+"-")&&c.push(db.op.keys[d]);c.sort(function(g,a){g=g.split("-");a=a.split("-");1===g.length&&g.push(0);1===a.length&&a.push(0);return g[0]<a[0]?-1:g[0]>a[0]?1:Number(g[1])<Number(a[1])?-1:1});return c},main=function(){document.querySelector(".add-btn").addEventListener("click",function(){openModalPrompt()});document.querySelector(".close-btn").addEventListener("click",
function(){gtag("event","\ub300\uc6d0 \ucd94\uac00 \ud504\ub86c\ud504\ud2b8 \ub2eb\uae30: \ubc84\ud2bc \ud074\ub9ad",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"});closeModalPrompt(!0)});window.addEventListener("mousedown",function(b){"modal"===b.target.getAttribute("id")&&(gtag("event","\ub300\uc6d0 \ucd94\uac00 \ud504\ub86c\ud504\ud2b8 \ub2eb\uae30: \uc678\ubd80 \ud074\ub9ad",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"}),
closeModalPrompt(!0))});document.getElementById("opname").addEventListener("keyup",function(b){gtag_searchByNameUsed||(gtag_searchByNameUsed=!0,gtag("event","\ub300\uc6d0 \uc774\ub984\uc73c\ub85c \ucd5c\ucd08 \uac80\uc0c9",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"}));if(13===b.keyCode){for(;0<document.querySelectorAll(".search-result-op").length;)document.querySelector(".search-result-op").click();this.value="";searchingCondition.name=""}else{b=
"";for(var c=this.value.split(" "),d=0,g=c.length;d<g;++d)0!==c[d].length&&(0<d&&(b+=" "),b+=c[d][0].toUpperCase()+c[d].slice(1).toLowerCase());searchingCondition.name=b;showSearchResult()}});document.querySelectorAll(".rarity-btn").forEach(function(b){b.addEventListener("click",function(){gtag_searchByRarityUsed||(gtag_searchByRarityUsed=!0,gtag("event","\ub300\uc6d0 \ub808\uc5b4\ub3c4\ub85c \ucd5c\ucd08 \uac80\uc0c9",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"}));
var c=Number(this.getAttribute("name")),d=searchingCondition.rarityArray.indexOf(c);0<=d?(searchingCondition.rarityArray.splice(d,1),this.classList.remove("selected")):(searchingCondition.rarityArray.push(c),this.classList.add("selected"));showSearchResult()})});document.querySelectorAll(".class-btn").forEach(function(b){b.addEventListener("click",function(){gtag_searchByClassUsed||(gtag_searchByClassUsed=!0,gtag("event","\ub300\uc6d0 \ud074\ub798\uc2a4\ub85c \ucd5c\ucd08 \uac80\uc0c9",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"}));
var c=getTagCodeByKRTagName(this.getAttribute("name"));c&searchingCondition.tagCode?this.classList.remove("selected"):this.classList.add("selected");searchingCondition.tagCode^=c;showSearchResult()})});loadLocalStorage()},getTextWidth=function(b){var c="font-size:"+b.css("font-size")+";";c+="font-family:"+b.css("font-family")+";";b=$('<span style="'+c+'">'+b.html()+"</span>").appendTo("body");c=b.width();b.remove();return c},centerCnt=0,centerCacheHit=0,centerCache={},csp=[],ncsp=[],centerTime=0,
doNotCenter=!1,centerSelect=function(b){if(!doNotCenter){centerTime=Date.now();var c=b.options[b.selectedIndex].innerText,d=centerCache[c];d?(b.style.textIndent=d,csp.push(Date.now()-centerTime)):(d=$(b),b=getTextWidth($(b.options[b.selectedIndex])),b=(d.width()-b)/2,d.css("text-indent",b),centerCache[c]=b+"px",ncsp.push(Date.now()-centerTime))}},makeOpForm=function(b,c){c=void 0===c?{}:c;var d={},g=!0;c||(c={});"object"===typeof c.values&&(d=c.values);"boolean"===typeof c.asElement&&(g=c.asElement);
var a=Number(db.op[b].rarity),h=[0,0,1,2,2,2][a-1],e=getMaxLevel(h,a),m=[4,7,7][h];db.op[b].name.en.toLowerCase();var f=Number.isInteger(d["current-elite"])?d["current-elite"]:0,k=Number.isInteger(d["target-elite"])?d["target-elite"]:h,l=Number.isInteger(d["current-op-level"])?d["current-op-level"]:1,B=Number.isInteger(d["target-op-level"])?d["target-op-level"]:e,p=[];if(d["current-skill-level"]){d["current-skill-level"].forEach(function(y){p.push(1<=y&&10>=y?y:1)});e=0;for(var x=3-p.length;e<x;++e)p.push(1)}else p=
[1,1,1];var w=[];if(d["target-skill-level"])for(d["target-skill-level"].forEach(function(y){w.push(1<=y&&10>=y?y:m)}),e=0,x=3-w.length;e<x;++e)w.push(m);else w=[m,m,m];d='<div class="remove-op thumb rarity_'+a+'"><img alt='+db.op[b].releaseOrder+' src="./images/op/thumb/'+db.op[b].releaseOrder+'.png"></div><div class="elite"><span>\uc815\uc608\ud654</span><br><select class="current-elite">';for(e=0;e<=h;++e)d+='<option value="'+e+'"',e===f&&(d+=" selected"),d+=">"+e+"\ub2e8\uacc4</option>";d+='</select><span> \u25b8 </span><select class="target-elite">';
for(e=0;e<=h;++e)d+='<option value="'+e+'"',e===k&&(d+=" selected"),d+=">"+e+"\ub2e8\uacc4</option>";d=d+'</select></div><div class="opLevel"><hr><button type="button" class="set-current-op-level-to-max-btn">MAX</button><span> \ub808\ubca8 </span><button type="button" class="set-target-op-level-to-max-btn">MAX</button><br><input type="text" class="current-op-level" value="'+(l+'"><span> \u25b8 </span><input type="text" class="target-op-level" value="')+(B+'"></div><hr>');h=getNumOfSkills(b);if(0<
h)for(d+="<span>\uc2a4\ud0ac \ub808\ubca8</span><br>",d+='<div class="skill">',e=1;e<=h;++e){1<e&&(d+="<br>");d+="<span>"+e+"\uc2a4\ud0ac </span>";d+='<select class="current-skill-level" data-index="'+(e-1)+'">';for(f=1;10>=f;++f)d+='<option value="'+f+'"',f===p[e-1]&&(d+="selected"),d+=">"+f+"</option>";d+="</select>";d+="<span> \u25b8 </span>";d+='<select class="target-skill-level" data-index="'+(e-1)+'">';for(f=1;10>=f;++f)d+='<option value="'+f+'"',f===w[e-1]&&(d+="selected"),d+=">"+f+"</option>";
d+="</select>"}d+="</div></div>";return g?(g=document.createElement("div"),g.classList.add("op"),g.setAttribute("name","op_"+b),g.innerHTML=d,g):'<div class="op" name="op_'+b+'">'+d+"</div>"},convertOldIDToNewID=function(){gtag("event","ID \uccb4\uacc4 \uc804\ud658(\ubc84\uc804 1\uc5d0\uc11c 2\ub85c)",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"});var b={0:"LN02",1:"RL03",2:"LT77",3:"RE41",4:"LM04",5:"AZ01",6:"JC01",7:"AA01",8:"FO03",9:"FO01",10:"PL03",
11:"SS02",12:"LM20",13:"SR02",14:"RL06",15:"LM05",16:"NM01",17:"RL02",18:"GG01",19:"R001",20:"VC03",21:"SK01",22:"RR01",23:"SR27",24:"R137",25:"BS01",26:"GG03",27:"SR01",28:"RB01",29:"AA02",30:"LM08",31:"R132",32:"SS01",33:"RL04",34:"RL01",35:"R106",36:"AA03",37:"LT01",38:"ST01",39:"R110",40:"ST03",41:"KZ03",42:"SR03",43:"JC06",44:"YD01",45:"SG01",46:"SW01",47:"LM16",48:"LM12",49:"R130",50:"R128",51:"RL05",52:"JC05",53:"PL05",54:"USS2",55:"LM15",56:"PL04",57:"LM19",58:"BS02",59:"FO02",60:"MN02",61:"VC05",
62:"HT03",63:"PL02",64:"USS1",65:"SI01",66:"R119",67:"VC02",68:"US10",69:"R100",70:"IU04",71:"R123",72:"HK01",73:"VC04",74:"IU07",75:"R104",76:"MN03",77:"R107",78:"LT02",79:"BS03",80:"VC01",81:"ST02",82:"LM10",83:"R122",84:"KZ04",85:"RB02",86:"LM11",87:"AA04",88:"LN01",89:"IU05",90:"R124",91:"JC03",92:"USS3",93:"JC04",94:"R108",95:"SW02",96:"R105",97:"PA15",98:"PA42",99:"PA41",100:"PA62",101:"PA65",102:"PA43",103:"PA13",104:"PA44",105:"PA63",106:"PA12",107:"PA61",108:"PA14",109:"PA45",110:"PA64",
111:"PA11",112:"LT05",113:"BS04",114:"R303",115:"A44",116:"A43",117:"A41",118:"A42",119:"RCX3",120:"RCX2"},c=Object.keys(localStorage).filter(function(m){return 0<=m.indexOf("optotal_")}),d="",g="",a="";d="";for(var h=0,e=c.length;h<e;++h)a=c[h].split("_"),d=a[1],a[1]=b[d],a[1]?(a=a.join("_"),g=c[h],d=localStorage.getItem(g),localStorage.setItem(a,d),localStorage.removeItem(g)):console.error(d+": \uc624\ud37c\ub808\uc774\ud130 ID \uccb4\uacc4 \ucd5c\uc2e0\ud654 \uc2e4\ud328. \ub9e4\uce6d\ub418\ub294 ID\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc74c.");
localStorage.setItem("version_optotal_localStorage",JSON.stringify(db.idVersion.op))},sleep=function(b){return new Promise(function(c,d){setTimeout(c,b)})},loadLocalStorage=function(){console.log("loadLocalStorage");JSON.parse(localStorage.getItem("version_optotal_localStorage")||"1")<db.idVersion.op&&(console.log("\uc624\ud37c\ub808\uc774\ud130 ID \uccb4\uacc4 \ucd5c\uc2e0\ud654 \uc218\ud589"),convertOldIDToNewID());for(var b="current-elite target-elite current-op-level target-op-level current-skill-level target-skill-level".split(" "),
c={IDs:[]},d=0;d<db.op.keys.length;++d){var g=db.op.keys[d],a="optotal_"+g+"_";c[g]=[];for(var h=!1,e=0;e<b.length;++e)null!==localStorage.getItem(a+b[e])&&(c[g].push(b[e]),h=!0);h&&c.IDs.push(g)}if(0===c.IDs.length)document.getElementById("content-body").style.opacity=1,console.log("loadComplete");else{document.getElementById("selected-op-guide").style.display="none";c.IDs.sort(function(m,f){if(Number(db.op[m].rarity)>Number(db.op[f].rarity))return-1;if(Number(db.op[m].rarity)<Number(db.op[f].rarity))return 1;
m=m.split("-");f=f.split("-");if(m[0]<f[0])return-1;if(m[0]>f[0])return 1;1===m.length&&m.push(0);1===f.length&&f.push(0);return Number(m[1])<Number(f[1])?-1:1});Date.now();doNotRefreshResult=!0;b="";d=0;for(g=c.IDs.length;d<g;++d)b+='<div class="op" name="'+c.IDs[d]+'" style="color:#bbb;text-align:center;"><pre>\n\n\n\nLoading...</pre></div>';document.getElementById("selected-op").innerHTML=b;document.getElementById("content-body").style.opacity=1;setTimeout(function(){for(var m="",f=0,k=c.IDs.length;f<
k;++f){for(var l=c.IDs[f],B="optotal_"+l+"_",p={keys:[]},x=0,w=c[l].length;x<w;++x){var y=c[l][x],C=JSON.parse(localStorage.getItem(B+y));p[y]=C;p.keys.push(y)}m+=makeOpForm(l,{values:p,asElement:!1})}f=document.getElementById("selected-op");f.innerHTML=m;doNotCenter=!0;f.querySelectorAll(".op").forEach(function(I){addOpEventListener(I,!0)});doNotRefreshResult=!1;showResult();console.log("loadComplete")},0)}},removeAllInputData=function(b){gtag("event","\ubaa8\ub4e0 \uc785\ub825 \ub370\uc774\ud130 \uc0ad\uc81c: \ubc84\ud2bc \ud074\ub9ad",
{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"});confirm("\uc8fc\uc758: \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.\n\uc815\ub9d0 \uc774 \uc11c\ube44\uc2a4\uc758 \ubaa8\ub4e0 \ub370\uc774\ud130\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")?(Object.keys(localStorage).filter(function(c){return 0<=c.indexOf("optotal_")}).forEach(function(c){return localStorage.removeItem(c)}),location.reload()):(gtag("event",
"\ubaa8\ub4e0 \uc785\ub825 \ub370\uc774\ud130 \uc0ad\uc81c: \ucde8\uc18c",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"}),alert("\ub370\uc774\ud130 \uc0ad\uc81c\uac00 \ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))},triggerEvent=function(b,c,d){d=void 0===d?null:d;null!==d?b.dispatchEvent(new CustomEvent(c,{detail:d})):b.dispatchEvent(new CustomEvent(c))},getMaxElite=function(b){return[0,0,1,2,2,2][b-1]},getNumOfSkills=function(b,c){c=void 0===c?null:
c;var d=db.op[b].rarity;null===c&&(c=getMaxElite(d));if(null===db.op[b].skill){var g=b.split("-")[0];if(g===b||null===db.op[g].skill)return console.error("\ub2e4\uc74c \uc6d0\ubcf8 \uc624\ud37c\ub808\uc774\ud130\uc758 skill \uac12\uc774 null\uc784:",b),0;b=g}g=2<=getMaxElite(d)?db.op[b].skill.mastery.length:[0,0,1,2,2,3][d-1];var a=[1,2,3][c];void 0===a&&(console.error("elite \uac12\uc5d0 \ubb38\uc81c \uc788\uc74c:",c),a=[1,2,3][getMaxElite(d)]);a>g&&(a=g);return a},getMaxSkillLevel=function(b){return[4,
7,10][b]},opFormRecalcHandler=function(b){var c=this.getAttribute("name").split("_")[1],d=c.split("-")[0],g=c===d,a={};document.querySelectorAll('#selected-op [name^="op_'+d+'"]').forEach(function(n){var z=n.getAttribute("name").split("_")[1];a[z]={};a[z].form=n;a[z].currentEliteElem=n.querySelectorAll(".current-elite")[0];a[z].targetEliteElem=n.querySelectorAll(".target-elite")[0];a[z].currentLevelElem=n.querySelectorAll(".current-op-level")[0];a[z].targetLevelElem=n.querySelectorAll(".target-op-level")[0];
a[z].currentSkillLevelElems=n.querySelectorAll(".current-skill-level");a[z].targetSkillLevelElems=n.querySelectorAll(".target-skill-level");a[z].currentElite=Number(n.querySelector(".current-elite").value);a[z].targetElite=Number(n.querySelector(".target-elite").value);a[z].currentLevel=Number(n.querySelector(".current-op-level").value);a[z].targetLevel=Number(n.querySelector(".target-op-level").value);a[z].currentSkillLevels=Array.from(n.querySelectorAll(".current-skill-level"),function(K){return Number(K.value)});
a[z].targetSkillLevels=Array.from(n.querySelectorAll(".target-skill-level"),function(K){return Number(K.value)})});if(!g){var h=null===db.op[c].elite;var e=null===db.op[c].skill}h&&(a[c].currentElite=a[d].currentElite,a[c].targetElite=a[d].targetElite,a[c].currentLevel=a[d].currentLevel,a[c].targetLevel=a[d].targetLevel,a[c].currentEliteElem.disabled=!0,a[c].targetEliteElem.disabled=!0,a[c].currentLevelElem.disabled=!0,a[c].targetLevelElem.disabled=!0,this.querySelectorAll(".set-current-op-level-to-max-btn, .set-target-op-level-to-max-btn").forEach(function(n){return n.disabled=
!0}),this.querySelectorAll(".elite, .opLevel").forEach(function(n){return n.style.opacity=0}));e&&(a[c].currentSkillLevels=[].concat($jscomp.arrayFromIterable(a[d].currentSkillLevels)),a[c].targetSkillLevels=[].concat($jscomp.arrayFromIterable(a[d].targetSkillLevels)),a[c].currentSkillLevelElems.forEach(function(n){n.disabled=!0}),a[c].targetSkillLevelElems.forEach(function(n){n.disabled=!0}),this.querySelector(".skill").style.opacity=0);var m=[a[c].currentElite,a[c].targetElite,a[c].currentLevel,
a[c].targetLevel].concat($jscomp.arrayFromIterable(a[c].currentSkillLevels),$jscomp.arrayFromIterable(a[c].targetSkillLevels)),f=this.dataset.inputValue;f=f?f.split(",").map(Number):[];var k=!1;h=0;for(var l=m.length;h<l;++h)if(m[h]!==f[h]){k=!0;break}if(k){m=Number(db.op[c].rarity);getNumOfSkills(c);k=null;k=b.detail&&b.detail.from?b.detail.from:{type:"all"};if("all"===k.type)h=b=f=!0;else{if("elite"===k.type)h=b=f=!0;else if("level"===k.type)f=!1,b=!0,h=!1;else if("skill"===k.type){if(b=f=!1,h=
!0,!Number.isInteger(k.index)||0>k.index||3<=k.index){console.error("\uc778\ub371\uc2a4 \uc624\ub958:",k.index);return}}else{console.error("\ud0c0\uc785 \uc624\ub958:",k.type);return}if("current"!==k.position&&"target"!==k.position){console.error("\ud3ec\uc9c0\uc158 \uc624\ub958:",k.position);return}}e&&(h=!1);if(f&&(e=getMaxElite(m),a[c].currentElite>e&&(a[c].currentElite=e),a[c].targetElite>e&&(a[c].targetElite=e),a[c].targetElite<a[c].currentElite&&(a[c].targetElite=a[c].currentElite),g))for(var B in a)1==
a[B].currentEliteElem.disabled&&(a[B].currentElite=a[d].currentElite),1==a[B].targetEliteElem.disabled&&(a[B].targetElite=a[d].targetElite);if(h){for(var p in a)for(d=getMaxSkillLevel(a[p].currentElite),B=getNumOfSkills(p),e=0;e<B;++e)a[p].currentSkillLevels[e]>d&&(a[p].currentSkillLevels[e]=d);if("skill"===k.type&&"current"===k.position){var x=a[c].currentSkillLevels[k.index];if(7>x)for(var w in a)a[w].currentSkillLevels=a[w].currentSkillLevels.map(function(n){return x});else for(var y in a)a[y].currentSkillLevels=
a[y].currentSkillLevels.map(function(n){return 7>n?7:n})}else{var C=-Infinity;for(H in a){p=getNumOfSkills(H,a[H].currentElite);for(w=0;w<p&&(C=a[H].currentSkillLevels[w]>C?a[H].currentSkillLevels[w]:C,C=7<C?7:C,7!==C);++w);if(7===C)break}for(var I in a)a[I].currentSkillLevels=a[I].currentSkillLevels.map(function(n){return n<C?C:n})}console.log(JSON.parse(JSON.stringify(a)));for(var u in a){var H=getMaxSkillLevel(a[u].targetElite);I=getNumOfSkills(u);for(p=0;p<I;++p)a[u].targetSkillLevels[p]<a[u].currentSkillLevels[p]?
a[u].targetSkillLevels[p]=a[u].currentSkillLevels[p]:a[u].targetSkillLevels[p]>H&&(a[u].targetSkillLevels[p]=H)}if("skill"===k.type&&"target"===k.position){var L=a[c].targetSkillLevels[k.index];if(7>L)for(var D in a)a[D].targetSkillLevels=a[D].targetSkillLevels.map(function(n){return L});else for(var G in a)a[G].targetSkillLevels=a[G].targetSkillLevels.map(function(n){return 7>n?7:n})}else{var F=-Infinity;for(q in a){u=getNumOfSkills(q,a[q].targetElite);for(D=0;D<u&&(F=a[q].targetSkillLevels[D]>F?
a[q].targetSkillLevels[D]:F,F=7<F?7:F,7!==F);++D);if(7===F)break}for(var v in a)a[v].targetSkillLevels=a[v].targetSkillLevels.map(function(n){return n<F?F:n})}}if(b)for(var r in a){var q=getMaxLevel(a[r].currentElite,m);a[r].currentLevel>q&&(a[r].currentLevel=q);1>a[r].currentLevel&&(a[r].currentLevel=1);q=getMaxLevel(a[r].targetElite,m);a[r].targetLevel>q&&(a[r].targetLevel=q);a[r].currentElite===a[r].targetElite&&a[r].targetLevel<a[r].currentLevel?a[r].targetLevel=a[r].currentLevel:1>a[r].targetLevel&&
(a[r].targetLevel=1)}if(f){r=null;for(var E in a){q=getMaxElite(db.op[E].rarity);r=a[E].currentEliteElem.options;v=0;for(u=q;v<u;++v)r[v].disabled=v>q?!0:!1;a[E].currentEliteElem.value=a[E].currentElite;r=a[E].targetEliteElem.options;v=0;for(u=r.length;v<u;++v)r[v].disabled=v<a[E].currentElite||v>q?!0:!1;a[E].targetEliteElem.value=a[E].targetElite}}if(h)for(var t in a){E=getNumOfSkills(t);q=getNumOfSkills(t,a[t].currentElite);r=getNumOfSkills(t,a[t].targetElite);v=getMaxSkillLevel(a[t].currentElite);
h=getMaxSkillLevel(a[t].targetElite);for(u=0;u<q;++u){a[t].currentSkillLevelElems[u].disabled=!1;D=a[t].currentSkillLevelElems[u].options;G=0;for(m=D.length;G<m;++G)D[G].disabled=G>=v?!0:!1;a[t].currentSkillLevelElems[u].value=a[t].currentSkillLevels[u]}for(;q<E;++q)a[t].currentSkillLevelElems[q].disabled=!0,a[t].currentSkillLevelElems[q].value=a[t].currentSkillLevels[q];for(q=0;q<r;++q){a[t].targetSkillLevelElems[q].disabled=!1;v=a[t].targetSkillLevelElems[q].options;u=0;D=v.length;for(G=a[t].currentSkillLevels[q]-
1;u<D;++u)v[u].disabled=u<G||u>=h?!0:!1;a[t].targetSkillLevelElems[q].value=a[t].targetSkillLevels[q]}for(;r<E;++r)a[t].targetSkillLevelElems[r].disabled=!0,a[t].targetSkillLevelElems[r].value=a[t].targetSkillLevels[r]}if(b)for(var J in a)a[J].currentLevelElem.value=a[J].currentLevel,a[J].targetLevelElem.value=a[J].targetLevel;for(var A in a)a[A].form.dataset.inputValue=[a[A].currentElite,a[A].targetElite,a[A].currentLevel,a[A].targetLevel].concat($jscomp.arrayFromIterable(a[A].currentSkillLevels),
$jscomp.arrayFromIterable(a[A].targetSkillLevels)).join(","),t="optotal_"+A+"_",localStorage.setItem(t+"current-elite",JSON.stringify(a[A].currentElite)),localStorage.setItem(t+"current-op-level",JSON.stringify(a[A].currentLevel)),localStorage.setItem(t+"current-skill-level",JSON.stringify(a[A].currentSkillLevels)),localStorage.setItem(t+"target-elite",JSON.stringify(a[A].targetElite)),localStorage.setItem(t+"target-op-level",JSON.stringify(a[A].targetLevel)),localStorage.setItem(t+"target-skill-level",
JSON.stringify(a[A].targetSkillLevels));if(g)for(c=document.querySelectorAll('#selected-op [name^="op_'+c+'-"]'),h=0;h<c.length;++h)triggerEvent(c[h],"recalc");showResult()}else console.log(c,"nodiff: return")},removeOpMousedownHandler=function(){var b=this.closest(".op").getAttribute("name").split("_")[1].split("-")[0];document.querySelectorAll('#selected-op [name^="op_'+b+'"]').forEach(function(c){return c.style.opacity=.4})},removeOpMouseoverHandler=function(){var b=this.closest(".op").getAttribute("name").split("_")[1].split("-")[0];
document.querySelectorAll('#selected-op [name^="op_'+b+'"]').forEach(function(c){return c.style.opacity=.7})},removeOpMouseoutHandler=function(){var b=this.closest(".op").getAttribute("name").split("_")[1].split("-")[0];document.querySelectorAll('#selected-op [name^="op_'+b+'"]').forEach(function(c){return c.style.opacity=1})},removeOpClickHandler=function(){gtag("event","\uc624\ud37c\ub808\uc774\ud130 \uc0ad\uc81c: \ubc84\ud2bc \ud074\ub9ad",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"});
this.closest(".op");var b=this.closest(".op").getAttribute("name").split("_")[1];b=getAllIDs(b);for(var c=0;c<b.length;++c){document.querySelector('#selected-op [name="op_'+b[c]+'"]').remove();for(var d="optotal_"+b[c]+"_",g="current-elite target-elite current-op-level target-op-level current-skill-level target-skill-level".split(" "),a=0;a<g.length;++a)localStorage.removeItem(d+g[a])}null===document.querySelector('div[name*="op_"].op')&&(document.getElementById("selected-op-guide").style.display=
"block");showResult()},setCurrentOpLevelToMaxHandler=function(){gtag("event","\ud604\uc7ac \ub808\ubca8 \ucd5c\ub300 \uc124\uc815",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"});if(!this.disabled){var b=this.closest(".op"),c=b.getAttribute("name").split("_")[1],d=b.querySelector(".current-op-level");if(c in db.op){var g=Number(b.querySelector(".current-elite").value);c=getMaxLevel(g,Number(db.op[c].rarity));d.value=c;triggerEvent(b,"recalc",{from:{type:"level",
position:"current"}})}else console.error("\uc5d0\ub7ec: \ucde8\ub4dd\ud55c \uc624\ud37c\ub808\uc774\ud130 \uc544\uc774\ub514("+c+")\ub97c DB\uc5d0\uc11c \ucc3e\uc744 \uc218 \uc5c6\uc74c")}},setTargetOpLevelToMaxHandler=function(){gtag("event","\ubaa9\ud45c \ub808\ubca8 \ucd5c\ub300 \uc124\uc815",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"});if(!this.disabled){var b=this.closest(".op"),c=b.getAttribute("name").split("_")[1],d=b.querySelector(".target-op-level");
if(c in db.op){var g=Number(b.querySelector(".target-elite").value);c=getMaxLevel(g,Number(db.op[c].rarity));d.value=c;triggerEvent(b,"recalc",{from:{type:"level",position:"target"}})}else console.error("\uc5d0\ub7ec: \ucde8\ub4dd\ud55c \uc624\ud37c\ub808\uc774\ud130 \uc544\uc774\ub514("+c+")\ub97c DB\uc5d0\uc11c \ucc3e\uc744 \uc218 \uc5c6\uc74c")}},currentEliteChangeHandler=function(){this.disabled||triggerEvent(this.closest(".op"),"recalc",{from:{type:"elite",position:"current"}})},targetEliteChangeHandler=
function(){this.disabled||triggerEvent(this.closest(".op"),"recalc",{from:{type:"elite",position:"target"}})},currentOpLevelChangeHandler=function(){this.disabled||triggerEvent(this.closest(".op"),"recalc",{from:{type:"level",position:"current"}})},targetOpLevelChangeHandler=function(){this.disabled||triggerEvent(this.closest(".op"),"recalc",{from:{type:"level",position:"target"}})},currentSkillLevelChangeHandler=function(b){this.disabled||triggerEvent(this.closest(".op"),"recalc",{from:{type:"skill",
position:"current",index:Number(b.target.dataset.index)}})},targetSkillLevelChangeHandler=function(){this.disabled||triggerEvent(this.closest(".op"),"recalc",{from:{type:"skill",position:"target",index:Number(event.target.dataset.index)}})},addOpEventListener=function(b,c){c=void 0===c?!1:c;b.addEventListener("recalc",opFormRecalcHandler);b.querySelector(".remove-op").addEventListener("mousedown",removeOpMousedownHandler);b.querySelector(".remove-op").addEventListener("mouseover",removeOpMouseoverHandler);
b.querySelector(".remove-op").addEventListener("mouseout",removeOpMouseoutHandler);b.querySelector(".remove-op").addEventListener("click",removeOpClickHandler);b.querySelector(".set-current-op-level-to-max-btn").addEventListener("click",setCurrentOpLevelToMaxHandler);b.querySelector(".set-target-op-level-to-max-btn").addEventListener("click",setTargetOpLevelToMaxHandler);b.querySelector(".current-elite").addEventListener("change",currentEliteChangeHandler);b.querySelector(".target-elite").addEventListener("change",
targetEliteChangeHandler);b.querySelector(".current-op-level").addEventListener("change",currentOpLevelChangeHandler);b.querySelector(".target-op-level").addEventListener("change",targetOpLevelChangeHandler);b.querySelectorAll(".current-skill-level").forEach(function(d){d.addEventListener("change",currentSkillLevelChangeHandler)});b.querySelectorAll(".target-skill-level").forEach(function(d){d.addEventListener("change",targetSkillLevelChangeHandler)});c&&triggerEvent(b,"recalc",{from:{type:"all"}})},
searchingCondition={name:"",rarityArray:[],tagCode:0},getTagCodeByKRTagName=function(b){for(var c=0;c<db.tag.keys.length;++c)if(db.tag[db.tag.keys[c]].name.kr==b)return Number(db.tag[db.tag.keys[c]].tagCode)},showSearchResult=function(){searchingCondition.rarityArray.sort(function(h,e){return h>e?-1:1});for(var b=searchOp(searchingCondition.name,searchingCondition.rarityArray,searchingCondition.tagCode),c=[],d=0,g=b.keys.length,a="";d<g;++d)a=b.keys[d],c.push([b[a].name.kr,a]);c.sort(function(h,e){return h[0].localeCompare(e[0])});
b="";for(d=0;d<c.length;++d)b+='<div class="search-result-op" name="op_'+c[d][1]+'"><img src="./images/op/thumb/'+db.op[c[d][1]].releaseOrder+'.png"><div><span>'+c[d][0]+"</span></div></div>";""==b&&(b='<p style="font-size: 0.5em; text-align: center">\uac80\uc0c9 \uacb0\uacfc\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.</p>');document.querySelector(".modal-footer>.search-result").innerHTML=b;document.querySelectorAll(".search-result-op").forEach(function(h){h.addEventListener("click",
function(){for(var e=this.getAttribute("name").split("_")[1],m=e.split("-")[0],f=getAllIDs(e),k=0;k<f.length;++k)if(console.log(f[k],"\ucd94\uac00"),"optotal_"+f[k]+"_current-elite"in localStorage)console.error(e+": \uc774\ubbf8 \ucd94\uac00\ub41c \uc624\ud37c\ub808\uc774\ud130");else{var l=makeOpForm(f[k],{values:{},asElement:!0});document.getElementById("selected-op").appendChild(l);addOpEventListener(l,!0);document.getElementById("selected-op-guide").style.display="none";gtag("event","\uc624\ud37c\ub808\uc774\ud130 \ucd94\uac00",
{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"})}e=document.querySelectorAll('.search-result-op[name^="op_'+m+'"]');for(k=0;k<e.length;++k)e[k].remove();0===document.querySelectorAll(".modal-footer>.search-result>.search-result-op").length&&(document.querySelector(".modal-footer>.search-result").innerHTML='<p style="font-size: 0.5em; text-align: center">\uac80\uc0c9 \uacb0\uacfc\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.</p>')})});document.querySelectorAll(".search-result-op div").forEach(function(h){$(h).textfill()})};
(function(b){b.fn.textfill=function(c){c=parseInt(c,10);return this.each(function(){function d(){var a=g.parent(),h=a.height(),e=a.width();a=parseInt(g.css("font-size"),10);e/=g.width();var m=a*(e-.1);e=h/g.height();c=a*(e-.1);g.css("fontSize",0<c&&m>c?c:m)}var g=b("span",this);b(window).resize(function(){"block"===document.querySelector(".modal").style.display&&d()});d()})}})(jQuery);
var searchOp=function(b,c,d){b=b.replace(/(\s*)/g,"").toLowerCase();var g=0<b.length,a=0<c.length,h=0!=d;if(!(g||a||h))return{keys:[]};for(var e={},m=Object.keys(localStorage).filter(function(w){return 0===w.indexOf("optotal_")}),f=0,k=db.op.keys.length,l="",B="";f<k;++f){l=db.op.keys[f];B="optotal_"+l;for(var p=0,x=m.length;p<x&&0!==m[p].indexOf(B);++p);p<x||(e[l]={},e[l].rarity=db.op[l].rarity,e[l].tagCode=db.op[l].tagCode,e[l].name={},e[l].name.kr=db.op[l].name.kr,e[l].name.en=db.op[l].name.en,
e[l].name.jp=db.op[l].name.jp,e[l].name.cn=db.op[l].name.cn)}e.keys=Object.keys(e);if(g)for(f=0,k=e.keys.length,l="";f<k;++f)l=e.keys[f],0>e[l].name.kr.replace(/(\s*)/g,"").toLowerCase().indexOf(b)&&0>e[l].name.en.replace(/(\s*)/g,"").toLowerCase().indexOf(b)&&0>e[l].name.jp.replace(/(\s*)/g,"").toLowerCase().indexOf(b)&&0>e[l].name.cn.replace(/(\s*)/g,"").toLowerCase().indexOf(b)&&(delete e[l],e.keys.splice(f,1),--f,--k);if(a)for(b=!1,f=0,g=e.keys.length,l="";f<g;++f){l=e.keys[f];b=!1;p=0;for(x=
c.length;p<x;++p)if(rarity=c[p],e[l].rarity==rarity){b=!0;break}b||(delete e[l],e.keys.splice(f,1),--f,--g)}if(h)for(f=0,k=e.keys.length,l="";f<k;++f)l=e.keys[f],d&e[l].tagCode||(delete e[l],e.keys.splice(f,1),--f,--k);return e},addResultToMcalc=function(b){var c=fetchInputData();if(!1===c)showTooltip("\uc804\uc1a1\ud560 \ub370\uc774\ud130\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4",b.target,"error");else if(gtag("event","\uc7ac\ub8cc \uacc4\uc0b0\uae30\ub85c \uc804\uc1a1 \uc2dc\uc791",
{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"}),confirm("\uacb0\uacfc \ub370\uc774\ud130\ub97c \uc804\uc1a1\ud558\uc2dc\ub824\uba74 \ud655\uc778 \ubc84\ud2bc\uc744 \ub20c\ub7ec\uc8fc\uc2ed\uc2dc\uc624.")){c=sortResultData(calc(c));for(var d=0;d<c.total.IDs.length;++d){var g=Number(c.total.IDs[d]),a=Number(c.total[g]);a+=JSON.parse(localStorage.getItem("mcalc_item-need_"+g));localStorage.setItem("mcalc_item-need_"+g,JSON.stringify(a))}showTooltip("\uc131\uacf5\uc801\uc73c\ub85c \uacb0\uacfc \ub370\uc774\ud130\ub97c \uc804\uc1a1\ud558\uc600\uc2b5\ub2c8\ub2e4",
b.target,"success");confirm("\uc131\uacf5\uc801\uc73c\ub85c \uacb0\uacfc \ub370\uc774\ud130\ub97c \uc804\uc1a1\ud558\uc600\uc2b5\ub2c8\ub2e4.\n\ubc14\ub85c \uc7ac\ub8cc \uacc4\uc0b0\uae30\ub85c \uc774\ub3d9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&("1"==localStorage.getItem("preferred-version_mcalc")?location.href="mcalc-legacy.html":location.href="mcalc.html")}else gtag("event","\uc7ac\ub8cc \uacc4\uc0b0\uae30\ub85c \uc804\uc1a1 \ucde8\uc18c",{event_category:"\uc624\ud37c\ub808\uc774\ud130 \uc721\uc131 \uc790\uc6d0 \uacc4\uc0b0\uae30"}),
showTooltip("\ub370\uc774\ud130 \uc804\uc1a1\uc774 \ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4",b.target,"error")};main();