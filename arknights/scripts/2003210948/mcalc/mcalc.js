var itemOrder={keys:["\ud2b9\uc218\uc7ac\ub8cc","\uc77c\ubc18\uc7ac\ub8cc","\uc2a4\ud0ac\uac1c\ub860","\uce69\ub958"],"\ud2b9\uc218\uc7ac\ub8cc":[["D32\uac15","\ubc14\uc774\ud3f4\ub77c \ub098\ub178\ud50c\ub808\uc774\ud06c \uce69","\uc911\ud569\uc81c"],"RMA70-24;\ub9dd\uac04 \uc911\ud569\uccb4;\ud654\uc774\ud2b8 \ud638\uc2a4 \ucf5c;\uace0\uae09 \uc5f0\ub9c8\uc11d;\uc911\ud569\uc824;\uc5f4\ud569\uae08 \ub369\uc5b4\ub9ac".split(";"),"RMA70-12;\ub9dd\uac04 \uad11\uc11d;\ub85c\uc2dd \ucf5c;\uc5f0\ub9c8\uc11d;\uc824\ub77c\ud2f4;\uc5f4\ud569\uae08".split(";")],
"\uc77c\ubc18\uc7ac\ub8cc":["\ud3ec\ub3c4\ub2f9 \ud329;\ud3f4\ub9ac\uc5d0\uc2a4\ud14c\ub974 \ud329;\uac1c\ub7c9 \uc7a5\uce58;\uc815\uc81c \uc6d0\uc554;\uc544\ucf00\ud1a4 \ud329;\uc774\ucca0 \ud329".split(";"),"\ud3ec\ub3c4\ub2f9 \ubc88\ub4e4;\ud3f4\ub9ac\uc5d0\uc2a4\ud14c\ub974 \ubc88\ub4e4;\ub9ac\ub274\uc5bc \uc7a5\uce58;\uc6d0\uc554 \ud050\ube0c \ubc88\ub4e4;\uc544\ucf00\ud1a4 \uc751\uc9d1\uccb4 \ubc88\ub4e4;\uc774\ucca0 \ubc88\ub4e4".split(";"),"\ud3ec\ub3c4\ub2f9;\ud3f4\ub9ac\uc5d0\uc2a4\ud14c\ub974;\uc7a5\uce58;\uc6d0\uc554 \ud050\ube0c;\uc544\ucf00\ud1a4 \uc751\uc9d1\uccb4;\uc774\ucca0".split(";"),
"\ub300\uccb4\ub2f9;\uc5d0\uc2a4\ud14c\ub974 \uc6d0\ub8cc;\ud30c\uc190\ub41c \uc7a5\uce58;\uc6d0\uc554;\ub514\ucf00\ud1a4;\uc774\ucca0 \uc870\uac01".split(";")],"\uc2a4\ud0ac\uac1c\ub860":[["\uc2a4\ud0ac\uac1c\ub860 \uc81c3\uad8c","\uc2a4\ud0ac\uac1c\ub860 \uc81c2\uad8c","\uc2a4\ud0ac\uac1c\ub860 \uc81c1\uad8c"]],"\uce69\ub958":[["\uce69 \ucca8\uac00\uc81c","\uad6c\ub9e4\uc99d\uba85\uc11c"],"\ubc45\uac00\ub4dc \ub4c0\uc5bc \uce69;\uac00\ub4dc \ub4c0\uc5bc \uce69;\ub514\ud39c\ub354 \ub4c0\uc5bc \uce69;\uc2a4\ub098\uc774\ud37c \ub4c0\uc5bc \uce69;\uce90\uc2a4\ud130 \ub4c0\uc5bc \uce69;\uba54\ub515 \ub4c0\uc5bc \uce69;\uc11c\ud3ec\ud130 \ub4c0\uc5bc \uce69;\uc2a4\ud398\uc15c\ub9ac\uc2a4\ud2b8 \ub4c0\uc5bc \uce69".split(";"),
"\ubc45\uac00\ub4dc \uce69\uc14b;\uac00\ub4dc \uce69\uc14b;\ub514\ud39c\ub354 \uce69\uc14b;\uc2a4\ub098\uc774\ud37c \uce69\uc14b;\uce90\uc2a4\ud130 \uce69\uc14b;\uba54\ub515 \uce69\uc14b;\uc11c\ud3ec\ud130 \uce69\uc14b;\uc2a4\ud398\uc15c\ub9ac\uc2a4\ud2b8 \uce69\uc14b".split(";"),"\ubc45\uac00\ub4dc \uce69;\uac00\ub4dc \uce69;\ub514\ud39c\ub354 \uce69;\uc2a4\ub098\uc774\ud37c \uce69;\uce90\uc2a4\ud130 \uce69;\uba54\ub515 \uce69;\uc11c\ud3ec\ud130 \uce69;\uc2a4\ud398\uc15c\ub9ac\uc2a4\ud2b8 \uce69".split(";")]},
showItem=function(b){b="<hr>";for(var f=0;f<itemOrder.keys.length;++f){var d=itemOrder[itemOrder.keys[f]];b+='<div id="category_'+f+'">';for(var a=0;a<d.length;++a){for(var c=0;c<d[a].length;++c){var g=Number(d[a][c]),n=itemData[g].grade,h=getItem_have(g),k=getItem_need(g);h=null===h?"":h;k=null===k?"":k;h=0==h?"":h;k=0==k?"":k;b+='<div align="center" class="item grade_'+n+'" id="item_'+d[a][c]+'"><div class="item_thumb"><img src="./images/item/inv_2/';b+=itemData[g].name.kr;b+='.png"><span class="item_thumb_name">';
b+=itemData[g].name.kr;b+='</span><div class="item_thumb_quantity">0</div></div><div class="item_body"><div style="height:12px"></div><div class="item_body_have">\ubcf4\uc720\ub7c9<br><input type="text" class="item_body_have_input" value="';b+=h;b+='"></div><div class="item_body_need">\ud544\uc694\ub7c9<br><input type="text" class="item_body_need_input" value="';b+=k;b+='"></div></div></div>'}b+="<div></div>"}b+="<hr>";b+="</div>"}$(".item-container").html(b);$(".item_body_have_input").off("change keyup").on("change keyup",
function(){saveInputToLocalStorage(this,"have")&&$(this).closest(".item").trigger("refresh")});$(".item_body_need_input").off("change keyup").on("change keyup",function(){saveInputToLocalStorage(this,"need")&&$(this).closest(".item").trigger("refresh")});$(".item").off("refresh").on("refresh",function(){var m=$(this),q=Number(m.attr("id").split("_")[1]),e=0>=itemData[q].craft.length?[]:itemData[q].craft[0];var u=Number(getItem_need(q));q=Number(getItem_have(q));var r=v(this);u+=r;r=u-q;r=0>r?0:r;
var b=Object.keys(m.data());for(var a=0;a<b.length;++a)0===b[a].indexOf("availability_")&&m.removeData(b[a]);for(a=0;a<e.length;++a){b=Number(e[a][1]);var d=$("#item_"+e[a][0]);if(1===d.length){var c=d;var l=r*b;d=$(m);b=$(c);d=Number(d.attr("id").split("_")[1]);var f=Number(b.attr("id").split("_")[1]);l=Number(l);if(isNaN(l))console.log("\uc624\ub958: \ub9e4\uac1c\ubcc0\uc218\ub97c \uc22b\uc790\ub85c \ubcc0\ud658\ud560 \uc218 \uc5c6\uc74c",l);else{b.data("craftDemand_"+d,l);l=Number(getItem_have(f));
var g=Number(getItem_need(f)),p=t(c);v(c);l=l+p-g;c=w(c);g=[];for(p=0;p<c.length;++p){var h=$("#item_"+c[p]),k=b.data("craftDemand_"+c[p]),n=h.data("availability_"+f);n=void 0===n?0:n;l=0>l?0:l;l<k?(h.data("availability_"+f,l),l=0):(h.data("availability_"+f,k),l-=k);k=h.data("availability_"+f);n!=k&&c[p]!=d&&g.push(h)}for(p=0;p<g.length;++p)g[p].trigger("refresh");b.trigger("refresh")}}}m=t(this);x(this,q+m-u);y(this)});var v=function(m){m=$(m);var b=0;tmp=Object.keys(m.data()).sort();for(var e=0;e<
tmp.length;++e)0===tmp[e].indexOf("craftDemand_")&&(b+=m.data(tmp[e]));return b},w=function(b){var a=$(b);b=[];a=Object.keys(a.data()).sort();for(var e=0;e<a.length;++e)0===a[e].indexOf("craftDemand_")&&b.push(Number(a[e].split("_")[1]));return b},x=function(b,a){var e=$(b),c=e.find(".item_thumb");e=e.find(".item_thumb_quantity");e.text(a);0>a?(e.addClass("minus").removeClass("plus"),c.addClass("minus")):(0<a?e.addClass("plus").removeClass("minus"):e.removeClass("plus").removeClass("minus"),c.removeClass("minus"))},
t=function(b){b=$(b);var a=b.attr("id").split("_")[1];a=0>=itemData[a].craft.length?[]:itemData[a].craft[0];for(var e=!1,c=0;c<a.length;++c){var d=a[c][0],m=Number(a[c][1]),f=b.data("availability_"+d);if(void 0!==f){f=Number(f);if(isNaN(f)){console.log("\uac00\uc6a9\ub7c9 \ub370\uc774\ud130\uc758 \uac12\uc774 \ube44\uc815\uc0c1\uc801\uc784: ",this,"\uc758 jquery data \uc18d\uc131: avail_"+d+": "+$this.data("avail_"+d));return}d=parseInt(f/m,10);e=!1===e?d:d<e?d:e}}return!1===e?0:e},y=function(a){var b=
$(a),e=Number(b.attr("id").split("_")[1]),c=Number(getItem_have(e));var d=Number(getItem_need(e));var f=t(a);d=c+f-d;f=w(a);a=[];for(c=0;c<f.length;++c){var g=$("#item_"+f[c]),h=b.data("craftDemand_"+f[c]),k=g.data("availability_"+e);k=void 0===k?0:k;d=0>d?0:d;d<h?(g.data("availability_"+e,d),d=0):(g.data("availability_"+e,h),d-=h);h=g.data("availability_"+e);k!=h&&a.push(g)}for(c=0;c<a.length;++c)e=a[c].attr("id").split("_")[1],b=Number(getItem_have(e))+t(a[c]),e=Number(getItem_need(e))+v(a[c]),
x(a[c],b-e),y(a[c])};$(".item").trigger("refresh")},saveInputToLocalStorage=function(b,f){var d=$(b);if("have"===f){var a=d.closest(".item");a=Number(a.attr("id").split("_")[1]);var c=Number(d.val().replace(/[^0-9]/g,"")),g=Number(getItem_have(a));if(isNaN(c))return d.val(0===g?"":g),!1;setItem_have(a,c);d.val(0===c?"":c);return!0}if("need"===f){a=d.closest(".item");a=Number(a.attr("id").split("_")[1]);c=Number(d.val());g=Number(getItem_need(a));if(isNaN(c))return d.val(g),!1;setItem_need(a,c);return!0}console.log("invalid inputType:",
f);return!1};$(document).ready(function(){console.log(itemData);for(var b=0;b<itemOrder.keys.length;++b)for(var f=itemOrder[itemOrder.keys[b]],d=0;d<f.length;++d)for(var a=0;a<f[d].length;++a){a:{var c=f[d][a];for(var g=Object.keys(itemData).length,n=0;n<g;++n)if(itemData[n].name.kr===c){c=n;break a}c=-1}if(0>c){console.log(f[d][a],"error");return}f[d][a]=c}showItem()});